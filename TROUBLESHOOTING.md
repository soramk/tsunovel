# トラブルシューティングガイド

## 小説の取得に失敗する場合

### 1. CORSエラー

**症状**: ブラウザのコンソールに「CORS policy」エラーが表示される

**解決方法**:
- バックエンドAPIでCORSヘッダーが正しく設定されているか確認
- `api/fetch-novel.js`のCORS設定を確認

### 2. ncodeが抽出できない

**症状**: 「ncodeを抽出できませんでした」というエラー

**解決方法**:
- 入力したURLが正しい形式か確認
- 小説家になろうのURL形式:
  - `https://ncode.syosetu.com/n1234ab/`
  - `https://novel18.syosetu.com/n1234ab/` (R18)

### 3. 本文が取得できない

**症状**: タイトルと著者は取得できるが、本文が空または「あらすじ」のみ

**説明**:
- 現在の実装では、CORS制限により本文は取得できません
- 小説家になろうのAPIからはメタ情報（タイトル、著者、あらすじ）のみ取得可能です
- 本文を読む場合は、表示されたURLから小説家になろうのサイトにアクセスしてください

## デバッグ方法

### ブラウザのコンソールを確認

1. 開発者ツールを開く（F12）
2. 「Console」タブを選択
3. 以下のログを確認:
   - `API URL:` - 使用されているAPI URL
   - `Request URL:` - 入力された小説のURL
   - `Response status:` - APIのレスポンスステータス
   - `API Response:` - APIから返されたデータ

### ネットワークタブを確認

1. 開発者ツールの「Network」タブを開く
2. 小説をダウンロードしようとする
3. `/api/fetch-novel`へのリクエストを確認
4. リクエストのステータスコードとレスポンスを確認

## よくあるエラーメッセージ

### "CORSエラー: ブラウザから直接APIにアクセスできません"
- 小説家になろう以外のサイトから取得しようとしています
- 現在は小説家になろうのみサポートされています

### "ncodeを抽出できませんでした"
- URLの形式が正しくありません
- 小説家になろうの正しいURL形式を使用してください

### "ncodeを抽出できませんでした"
- URLの形式が正しくありません
- 小説家になろうの正しいURL形式を使用してください

## テスト方法

### 小説家になろうのAPIを直接テスト

ブラウザのコンソールで以下を実行：

```javascript
const ncode = 'n1234ab'; // テスト用のncode
const apiUrl = `https://api.syosetu.com/novelapi/api/?out=json&of=t-w-s&ncode=${ncode}`;

fetch(apiUrl)
  .then(res => res.json())
  .then(data => console.log(data))
  .catch(err => console.error('Error:', err));
```

## サポート

問題が解決しない場合は、以下を確認してください:

1. ブラウザのコンソール（F12）のエラーメッセージ
2. ネットワークタブのリクエスト/レスポンス
3. 入力したURLが正しい形式か確認（`https://ncode.syosetu.com/n1234ab/`）

## 現在の実装について

- **バックエンドAPI**: 使用していません
- **実装**: `src/utils/novelFetcher.js` でフロントエンドから直接APIを呼び出し
- **対応サイト**: 小説家になろうのみ（CORS制限のため）

